
## 功能说明

腾讯云 CDN 支持对单个域名进行版本管理，一个版本对应一份域名配置，您可以对域名部署不同的版本。支持生产环境和模拟环境两种部署环境方式：

- 生产环境：即现网环境，实际加速服务生效的环境。
- 模拟环境：即沙箱，仅做域名功能测试的独立环境。在模拟环境中部署版本后，CDN 会为域名分配一个 IPv4 的 IP，修改客户端 HOST，将域名指向该 IP 即可进行测试。

>!
>1. 每个环境中每次仅支持部署一个版本。
>2. 模拟环境仅为功能测试，其规模比生产环境小很多，不可用作实际业务或性能测试。
>3. 刷新功能将同时作用于生产环境和模拟环境。
>4. 暂仅支持中国境内，非 COS 源的域名启用版本管理。
>5. 此功为白名单功能，使用前请确保已开白。

## 使用场景

- 域名配置灰度测试。
- 域名不同配置的测试对比。



## 开启版本管理

登录 [CDN 控制台](https://console.cloud.tencent.com/cdn)，在菜单栏里选择【域名管理】，进入域名列表。点击要启用版本管理的域名，进入域名配置页面，右上角可看到【启用版本管理】。

确认启用后，当前域名的配置自动生成为第一个版本：Ver.1，同时部署至生产环境和模拟环境。

## 版本管理

启用版本管理后可进入【版本管理页面】 ，查看和管理版本。不同的版本用版本号 **Ver.n (n=1,2,3,...)** 区分。

### 发布版本

对于已启用版本管理的域名，建议采用以下发布版本的步骤：

1. 在模拟环境中上线要测试或发布的版本。
2. 测试已部署在模拟环境中的版本。
3. 若要调整配置再次测试，需新增版本并提交，生成新版本，重复步骤 1-2。
4. 测试通过后，将版本同步至生产环境，将配置下发现网，全网生效。
5. 若更换生产环境中的版本，请重复步骤 1-4。

>!
>- 仅允许将版本列表中最新的版本（即版本号最大的版本）发布至模拟环境，历史版本均仅支持查看。
>- 后端特殊配置会直接部署至生产环境，现网生效。
>- 若域名当前存在后端特殊配置，从测试环境同步版本至生产环境时可能会失败，此时请新建版本进行发布。

### 新增版本
单击【新增版本】：新增版本时的版本配置默认为当前生产环境中的版本，可在此基础上调整并提交，生产新版本。

### 编辑版本

版本列表中最新的版本未发布至模拟环境时，可以编辑。

历史版本（最新版本之前的所有版本）不论是否有发布至模拟环境，均不可编辑，仅支持查看。

>!新增版本前请确认是否还有未发布的版本，因为新增版本后该版本会自动变为历史版本，不可编辑也不可发布至模拟环境。

### 查看版本

单击对应版本操作列的【查看】，可查看该版本中的配置内容。

## 停用版本管理

对于正常运行中，已启用版本管理的域名，您也可以停用版本管理。停用后，将回复到基础的现网配置模式，以当前生产环境已上线的版本为现网配置。

若有需要，您可再次启用版本管理。
